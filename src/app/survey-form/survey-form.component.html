<div class="container">
  <mat-progress-bar mode="buffer" [hidden]="!submitting"></mat-progress-bar>
  <form (ngSubmit)="onSubmit()" #surveyForm="ngForm" [hidden]="submitted || submitting">
    <div class="row">
      <div class="email col-sm">
        <mat-form-field class="form-input-full-width">
          <input matInput placeholder="Email" pattern="[^ @]*@[^ @]*" [(ngModel)]="surveyModel.email" name="email" required>
        </mat-form-field>
      </div>
    </div>

    <div class="row">
      <div class="col-sm">
        <mat-form-field class="form-input-full-width">
          <mat-select placeholder="Hostel" [(ngModel)]="surveyModel.hostel" name="hostel" required>
            <mat-option *ngFor="let hostel of hostels" [value]="hostel">
              Hostel {{ surveyOptionsMapping['hostels'][hostel]}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
    <div class="row">
      <div class="col-sm">
        <div class="question-freq"><strong>How frequently do you visit canteen?</strong></div>
        <mat-radio-group class="freq-radio-group" [(ngModel)]="surveyModel.frequency" name="frequency" required>
          <mat-radio-button class="freq-radio-button" *ngFor="let frequency of frequencies" [value]="frequency">
            {{ surveyOptionsMapping['frequencies'][frequency] }}
          </mat-radio-button>
        </mat-radio-group>
      </div>
    </div>

    <div class="row">
      <div class="col-sm">
        <div class="question-quality">
          <strong>Rate the quality of food items in canteen</strong>
          <small class="text-muted">
            <p>5 - Very Good, 4 - Good, 3 - Satisfactory, 2 - Poor, 1 - Unacceptable</p>
          </small>
        </div>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th scope="col"></th>
                <th scope="col" *ngFor="let rating of ratings">{{surveyOptionsMapping['ratings'][rating]}}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of foodItems; let i = index">
                <th scope="row">{{ surveyOptionsMapping['foodItems'][item.itemId]}}</th>
                <td *ngFor="let rating of ratings" >
                  <mat-radio-group [(ngModel)]="surveyModel.foodItems[i].rating" name="fooditem{{i}}" required>
                    <mat-radio-button [value]="rating"></mat-radio-button>
                  </mat-radio-group>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm">
        <div class="question-hygiene">
          <strong>Rate on overall Hygiene level maintained in Canteen</strong>
          <small class="text-muted">
            <p>5 - Very Good, 4 - Good, 3 - Satisfactory, 2 - Poor, 1 - Unacceptable</p>
          </small>
        </div>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th scope="col"></th>
                <th scope="col" *ngFor="let rating of ratings">{{surveyOptionsMapping['ratings'][rating]}}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of hygieneOfItems; let i = index">
                <th scope="row">{{surveyOptionsMapping['hygieneOfItems'][item.itemId]}}</th>
                <td *ngFor="let rating of ratings" >
                  <mat-radio-group [(ngModel)]="surveyModel.hygieneOfItems[i].level" name="hygieneofitem{{i}}" required>
                    <mat-radio-button [value]="rating"></mat-radio-button>
                  </mat-radio-group>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-sm">
        <div class="question-absence"><strong>How often do you encounter with the absence of menu item or any other item?</strong></div>
        <mat-radio-group class="absence-radio-group" [(ngModel)]="surveyModel.absenceMenuItemTimes" name="absence" required>
          <mat-radio-button class="absence-radio-button" *ngFor="let times of absenceMenuItemTimes" [value]="times">
            {{ surveyOptionsMapping['absenceMenuItemTimes'][times] }}
          </mat-radio-button>
        </mat-radio-group>
      </div>
    </div>

    <div class="row">
      <div class="col-sm">
        <div class="question-other-parameters">
            <strong>Other Parameters</strong>:
          <small class="text-muted">
            <p>5 - Very Good, 4 - Good, 3 - Satisfactory, 2 - Poor, 1 - Unacceptable</p>
          </small>
        </div>
        <div class="table-responsive">
          <table class="table">
            <thead>
              <tr>
                <th scope="col"></th>
                <th scope="col" *ngFor="let rating of ratings">{{surveyOptionsMapping['ratings'][rating]}}</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let parameter of otherParameters; let i = index">
                <th scope="row">{{surveyOptionsMapping['otherParameters'][parameter.parameterId]}}</th>
                <td *ngFor="let rating of ratings" >
                  <mat-radio-group [(ngModel)]="surveyModel.otherParameters[i].rating" name="parameter{{i}}" required>
                    <mat-radio-button [value]="rating"></mat-radio-button>
                  </mat-radio-group>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <div class="row">
      <div class="col-sm">
        <div><strong>Other Suggestions/Comments</strong></div>
        <mat-form-field class="form-input-full-width">
          <textarea matInput placeholder="Your answer" [(ngModel)]="surveyModel.otherSuggestions" name="suggestion"></textarea>
        </mat-form-field>
      </div>
    </div>

    <div class="row">
      <div class="col-sm">
          <button mat-raised-button color="primary" [disabled]="!surveyForm.form.valid">Submit</button>
      </div>
    </div>

  </form>

  <!-- <pre>{{ diagnostic | json }}</pre> -->

  <div class="row" [hidden]="!submitted">
    <div class="col-sm">
      Thank you for submitting the form
    </div>
  </div>
</div>
